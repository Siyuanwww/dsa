# PA2-1-1 Report

作者：丁思源 2022012901

实现一个分块数组，数组之间采用链表的形式连接。

对于同一个块内的插入、删除和查询都非常简单，对于某个元素的块定位只需要遍历一遍链表，计算前缀的块大小之和就可以了。代码中最难的是块内元素达到最大容量后如何分裂：我们采用了平均分成两个大小相同的块的方法。假设块的大小为 $M$，这意味着插入 $\mathcal O(\frac{M}{2})$ 个元素才会造成一次分裂操作，每次分裂的时间复杂度也是 $\mathcal O(M)$，根据均摊分析的思想，分裂操作均摊到每个元素的时间复杂度是 $\mathcal O(1)$。

接下来确定每个块的大小。

- 对于插入操作：需要遍历 $\mathcal O(\frac{n}{M})$ 个块，块内复杂度是 $\mathcal O(M)$，其中每次插入 $\mathcal O(M)$ 个元素才会带来一次 $\mathcal O(M)$ 的分裂。
- 对于删除操作同理。

因此总的复杂度是 $O(N \cdot (\frac{n}{M} + M) + \frac{n}{M} \cdot M)$，前一部分是插入/删除的复杂度，后一部分是分裂的复杂度。

理论上 $M = \sqrt n$ 时时间复杂度最优，但是由于分裂操作的常数很大，加上本地随机数据测试的结果，$M$ 可以放大若干倍。

在代码实现过程中，可以将链表的头尾指针指向两个空块，从而降低代码复杂度。

时间复杂度：$\mathcal O(n \sqrt n)$

空间复杂度：$\mathcal O(n)$

---

困难和参考资料：无

用时：1h
