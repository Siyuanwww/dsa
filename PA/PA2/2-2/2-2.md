# PA2-2-2 Report

作者：丁思源 2022012901

给定一个 $n \times m$ 的矩阵，其中若干个位置是障碍，求有多少个大小小于 $n_{\max} \times m_{\max}$ 的小矩阵。

~~评价：单调队列模板题。~~

我们每次将小矩形的右下角限定在某一行，那么就是一个简单的直方图矩形计数问题，只需要利用一个单调不减的单调队列，下面简单讲讲实现原理。

由于小矩形的行列有限制（列数可以直接对直方图的高度取 $\min$），单调队列中的每个元素是一个三元组，分别是位置 $id$，该位置直方图的高度 $val$，以该位置作为小矩形的右下角并且左边界不达到队列中上一个元素 $id'$ 的小矩形一共有 $ans$ 个。

那么，当我们考虑直方图的第 $i$ 列时，先把队尾所有 $val$ 大于当前值的元素依次弹出，考察队首元素时，会出现两种情况：

1. 队首元素的 $id$ 已经不满足限制条件了，那么直接弹出。
2. 队首元素满足条件，但是由于小矩形左边界可行区间的左端点 $i - m_{\max} + 1$ 由于 $i$ 增加而增加，队首的 $ans$ 会减小，此时只需要将队首的方案数减去队首的直方图高度即可。

最后将当前位置 $i$ 的信息入队。此时的答案就是队列中所有的 $ans$ 之和。

代码实现过程中，需要注意题目中的 $n$ 和 $m$ 到底是行数还是列数，并且要注意队首元素的两种情况。

时间复杂度：$\mathcal O(nm)$

空间复杂度：$\mathcal O(nm)$

---

困难和参考资料：无

用时：2h
