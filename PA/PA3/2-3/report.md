# PA3-2-3 Kidd Report

要求实现一棵需要区间离散化的线段树，支持区间修改、区间查询。

唯一的难点就是在普通线段树的基础上加上区间离散化。考虑如下区间：

```plain
[3,8] [5,12] [15,16]
```

我们将这些端点以插板的形式表示出来：

```plain
1 2 | 3 4 | 5 6 7 8 | 9 10 11 12 | 13 14 | 15 16 | 17 18 19 20 ...
```

可以发现只需要提取出点 2，4，8，12，14，16，第 $i$ 个点 $x_i$ 可以代表 $(x_{i - 1}, x_{i}]$ 这个区间的信息。

因此，需要进行离散化的点集为 $\set{l_i - 1 \mid 1 \le i \le m} \cup \set{r_i \mid 1 \le i \le m}$。

此外题目中涉及的所有操作都是线段树的常规操作。代码实现中唯一需要注意的问题是：对线段树上的区间 $[l, r]$ 进行修改操作时，区间的实际长度需要按照离散化之前的区间端点计算。

时间复杂度：$\mathcal O(m \log m)$

空间复杂度：$\mathcal O(m)$

---

困难和参考资料：无

用时：1h
